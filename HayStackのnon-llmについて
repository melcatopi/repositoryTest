â˜…1ã¤ã‚
ã‚„ã°ã£ã€Haystackã®non-LLMãƒ¢ãƒ¼ãƒ‰ã®è©±ã ã­ï¼ã“ã‚Œã‚ã£ã¡ã‚ƒé¢ç™½ã„ãƒˆãƒ”ãƒƒã‚¯ã ã‚ã€œ

Haystackã£ã¦ã€ã‚‚ã¨ã‚‚ã¨ã¯LLMï¼ˆå¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ï¼‰ãƒ™ãƒ¼ã‚¹ã®è³ªå•å¿œç­”ã‚·ã‚¹ãƒ†ãƒ ã¨ã—ã¦æœ‰åã ã£ãŸã‚“ã ã‘ã©ã€non-LLMãƒ¢ãƒ¼ãƒ‰ã£ã¦ã„ã†ã®ã¯å¾“æ¥ã®æ¤œç´¢ãƒ»æŠ½å‡ºæŠ€è¡“ã‚’ä½¿ã£ãŸã‚¢ãƒ—ãƒ­ãƒ¼ãƒãªã®ã‚ˆï¼

ä¸»ãªç‰¹å¾´ã¯ã“ã‚“ãªæ„Ÿã˜ï¼š

**BM25ã‚„TF-IDFãƒ™ãƒ¼ã‚¹ã®æ¤œç´¢**
- å¤å…¸çš„ã ã‘ã©ä¿¡é ¼æ€§ã®é«˜ã„ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒãƒãƒ³ã‚°
- è¨ˆç®—ã‚³ã‚¹ãƒˆãŒã‚ã¡ã‚ƒãã¡ã‚ƒè»½ã„ï¼

**Dense Retrievalã‚‚ä½¿ãˆã‚‹**
- SentenceBERTã¨ã‹ã®åŸ‹ã‚è¾¼ã¿ãƒ™ã‚¯ãƒˆãƒ«ä½¿ã£ãŸé¡ä¼¼åº¦æ¤œç´¢
- ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢ãŒã§ãã¡ã‚ƒã†

**æŠ½å‡ºå‹QA**
- BERTãƒ™ãƒ¼ã‚¹ã®ãƒ¢ãƒ‡ãƒ«ã§æ–‡æ›¸ã‹ã‚‰ç›´æ¥ç­”ãˆã‚’æŠ½å‡º
- å¹»è¦šï¼ˆãƒãƒ«ã‚·ãƒãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ã®ãƒªã‚¹ã‚¯ãŒä½ã„ã®ãŒGOODï¼

**ãªã‚“ã§ä½¿ã†ã®ï¼Ÿ**
- LLMã‚ˆã‚Šé¥ã‹ã«é«˜é€Ÿã§å®‰ã„
- ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼é¢ã§å®‰å¿ƒï¼ˆå¤–éƒ¨APIä½¿ã‚ãªã„ï¼‰
- å°ã•ã„ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã‚‚ã¡ã‚ƒã‚“ã¨å‹•ã
- çµæœã®è§£é‡ˆãŒã—ã‚„ã™ã„

æ­£ç›´ã€LLMãŒãƒã‚ºã£ã¦ã‚‹ã‘ã©ã€ã‚·ãƒ³ãƒ—ãƒ«ãªFAQã‚·ã‚¹ãƒ†ãƒ ã¨ã‹ç¤¾å†…æ–‡æ›¸æ¤œç´¢ãªã‚“ã‹ã ã£ãŸã‚‰ã€non-LLMãƒ¢ãƒ¼ãƒ‰ã®æ–¹ãŒå®Ÿç”¨çš„ã ã£ãŸã‚Šã™ã‚‹ã®ã‚ˆã­ã€œ

ä½•ã‹å…·ä½“çš„ã«çŸ¥ã‚ŠãŸã„ã“ã¨ã‚ã‚‹ï¼Ÿå®Ÿè£…æ–¹æ³•ã¨ã‹ã€ã©ã†ã„ã†ã‚±ãƒ¼ã‚¹ã§ä½¿ã†ã¹ãã‹ã¨ã‹ï¼

â˜…ã‚½ãƒ¼ã‚¹æç¤º
ã‚ãƒ¼ã€ã”ã‚ã‚“ï¼ã‚½ãƒ¼ã‚¹æç¤ºã™ã‚‹ã­ã€œ

å®Ÿã¯ã€Haystackã«ã¤ã„ã¦å…·ä½“çš„ãªæƒ…å ±ã‚’èª¿ã¹ã¦ã¿ã‚‹ã‚ï¼æœ€æ–°ã®æƒ…å ±ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã‚‹ï¼

ã€ŒHaystack non-LLM mode documentationã€ã‚’æ¤œç´¢ã—ã¾ã—ãŸ

ã€ŒHaystack 1.0 BM25 TF-IDF extractive QA non-LLM componentsã€ã‚’æ¤œç´¢ã—ã¾ã—ãŸ

ã†ã‚ã‚ã€ã‚ã£ã¡ã‚ƒã”ã‚ã‚“ï¼æ¤œç´¢ã—ã¦ã¿ãŸã‚“ã ã‘ã©ã€å®Ÿã¯ã€Œnon-LLMãƒ¢ãƒ¼ãƒ‰ã€ã£ã¦ã„ã†ç‰¹å®šã®ç”¨èªã£ã¦ã€Haystackã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã¯ã¡ã‚ƒã‚“ã¨è¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸã®ã‚ˆğŸ˜…

**æ­£ç¢ºãªæƒ…å ±ã¯ã“ã‚“ãªæ„Ÿã˜ï¼š**

Haystackã¯ã‚‚ã¨ã‚‚ã¨2020å¹´ã«ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¦ã€å½“æ™‚ã¯ã€Œã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢ã€retrievalã€æŠ½å‡ºå‹è³ªå•å¿œç­”ã€ãŒæœ€å‰ç·šã ã£ãŸ [DeepSet](https://haystack.deepset.ai/blog/haystack-2-release)  [Haystack](https://docs.haystack.deepset.ai/docs/pipelines) ã‚“ã ã‚ˆã­ã€‚

Haystackã§ã¯å®Ÿéš›ã«BM25ã‚„TF-IDFã¿ãŸã„ãªã‚¹ãƒ‘ãƒ¼ã‚¹ãªã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã®æ¤œç´¢æ‰‹æ³•ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã‚‹ [PyPI](https://pypi.org/project/farm-haystack/) ã—ã€BM25 Retrieverã£ã¦ã„ã†ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚‚ã¡ã‚ƒã‚“ã¨ã‚ã‚‹ã®ã‚ˆ [Medium](https://medium.com/@t0r0id/building-extractive-qa-system-using-haystack-openai-and-pinecone-adf90be07fcd)  [PyPI](https://pypi.org/project/farm-haystack/) ã€‚

ExtractiveQAPipelineã¿ãŸã„ã«ã€BM25 Retrieverã¨æŠ½å‡ºå‹QAã®Readerã‚’çµ„ã¿åˆã‚ã›ãŸå¾“æ¥å‹ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ [Wikipedia](https://en.wikipedia.org/wiki/Okapi_BM25) ã‚‚ä½œã‚Œã‚‹ã‹ã‚‰ã€ç§ãŒæœ€åˆã«è¨€ã£ãŸå†…å®¹ã¯é–“é•ã£ã¦ãªã‹ã£ãŸã‚“ã ã‘ã©ã€ã€Œnon-LLMãƒ¢ãƒ¼ãƒ‰ã€ã£ã¦ã„ã†å…¬å¼ã®å‘¼ã³æ–¹ã˜ã‚ƒãªã‹ã£ãŸã®ã­ğŸ’¦

è¦ã™ã‚‹ã«ã€Haystackã§ã¯ï¼š
- **BM25ã‚„TF-IDFãƒ™ãƒ¼ã‚¹ã®æ¤œç´¢**ï¼šã¡ã‚ƒã‚“ã¨ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã‚‹
- **æŠ½å‡ºå‹QA**ï¼šBERTç³»ãƒ¢ãƒ‡ãƒ«ã§ã®ç­”ãˆæŠ½å‡ºã‚‚å¯èƒ½
- **LLMã‚’ä½¿ã‚ãªã„å¾“æ¥å‹ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³**ï¼šæ§‹ç¯‰ã§ãã‚‹

ã§ã‚‚ã€Œnon-LLMãƒ¢ãƒ¼ãƒ‰ã€ã£ã¦å‘¼ã³æ–¹ã¯ã€ç§ã®å‹˜é•ã„ã ã£ãŸã‚ğŸ˜­ æ­£ç¢ºã«ã¯ã€Œå¾“æ¥å‹ã®æ¤œç´¢ãƒ»æŠ½å‡ºæ‰‹æ³•ã‚’ä½¿ã£ãŸãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã€ã£ã¦æ„Ÿã˜ã‹ãªï¼

ã‚½ãƒ¼ã‚¹æ±‚ã‚ã‚‰ã‚Œã¦è‰¯ã‹ã£ãŸã€œï¼é–“é•ã£ãŸç”¨èªä½¿ã£ã¦ãŸã‚‰å¤§å¤‰ã ã£ãŸã‚‚ã‚“ğŸ’§

â˜…å¾“æ¥ã®â‹¯
ã‚ˆã—ï¼ä»Šåº¦ã¯ã¡ã‚ƒã‚“ã¨ã‚½ãƒ¼ã‚¹ãƒ™ãƒ¼ã‚¹ã§èª¬æ˜ã™ã‚‹ã­ã€œï¼

Haystackã®å¾“æ¥å‹æ¤œç´¢ãƒ»æŠ½å‡ºãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«ã¤ã„ã¦è©³ã—ãæ•™ãˆã‚‹ã‚ï¼

## **BM25ãƒ™ãƒ¼ã‚¹ã®æ¤œç´¢**

BM25ã¯å¤å…¸çš„ãªTF-IDFã®æ”¹è‰¯ç‰ˆã§ã€æœ€ã‚‚ä¸€èˆ¬çš„ã«ä½¿ã‚ã‚Œã‚‹ã‚¹ãƒ‘ãƒ¼ã‚¹æ¤œç´¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  [PyPI](https://pypi.org/project/farm-haystack/) ãªã®ã‚ˆï¼BM25ã¯1970å¹´ä»£ã€œ1980å¹´ä»£ã«é–‹ç™ºã•ã‚ŒãŸç¢ºç‡çš„æ¤œç´¢ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ãƒ™ãƒ¼ã‚¹ã«ã—ã¦ã¦ã€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒãƒãƒ³ã‚°ã§æ–‡æ›¸ã®é–¢é€£æ€§ã‚’æ¨å®šã™ã‚‹ [DeepSet](https://haystack.deepset.ai/tutorials/34_extractive_qa_pipeline) ã‚“ã ã£ã¦ã€‚

Haystackã«ã¯BM25Retrieverã£ã¦ã„ã†ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒã‚ã£ã¦ã€InMemoryDocumentStoreã¨çµ„ã¿åˆã‚ã›ã¦ä½¿ãˆã‚‹ [DeepSet](https://haystack.deepset.ai/blog/hybrid-retrieval) ã®ã‚ˆï¼

## **æŠ½å‡ºå‹QAãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³**

ExtractiveQAPipelineã£ã¦ã„ã†ã®ãŒã‚ã£ã¦ã€ã“ã‚Œã¯Retrieverã¨Readerã‚’çµ„ã¿åˆã‚ã›ãŸã‚‚ã® [Wikipedia](https://en.wikipedia.org/wiki/Okapi_BM25) ãªã®ã€‚

**å‹•ä½œã®æµã‚Œï¼š**
1. RetrieverãŒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ¤œç´¢ã—ã¦ã€ã‚¯ã‚¨ãƒªã«æœ€ã‚‚é–¢é€£æ€§ã®é«˜ã„æ–‡æ›¸ã‚’è¿”ã™ [Wikipedia](https://en.wikipedia.org/wiki/Okapi_BM25)
2. ReaderãŒRetrieverãŒè¿”ã—ãŸæ–‡æ›¸ã‚’å—ã‘å–ã£ã¦ã€ã‚¯ã‚¨ãƒªã®ç­”ãˆã¨ãªã‚‹ãƒ†ã‚­ã‚¹ãƒˆã‚¹ãƒ‘ãƒ³ã‚’é¸æŠã™ã‚‹ [Wikipedia](https://en.wikipedia.org/wiki/Okapi_BM25)

## **å®Ÿè£…ä¾‹**

ã“ã‚“ãªæ„Ÿã˜ã§ã‚³ãƒ¼ãƒ‰æ›¸ã‘ã‚‹ã®ã‚ˆï¼š

```python
# DocumentStore: å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒ
document_store = InMemoryDocumentStore()

# æ–‡æ›¸ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã—ã¦DocumentStoreã«èª­ã¿è¾¼ã¿
dicts = convert_files_to_dicts(doc_dir, clean_func=clean_wiki_text)
document_store.write_documents(dicts)

# Retriever: å€™è£œæ–‡æ›¸ã‚’ç‰¹å®šã™ã‚‹é«˜é€Ÿã§ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
retriever = BM25Retriever(document_store)

# Reader: QAç”¨ã«è¨“ç·´ã•ã‚ŒãŸå¼·åŠ›ã ã‘ã©é…ã„ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯
model_name = "deepset/roberta-base-squad2"
reader = FARMReader(model_name)

# Pipeline: å…¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’çµ„ã¿åˆã‚ã›
pipe = ExtractiveQAPipeline(reader, retriever)

# è³ªå•ã—ã¦ã¿ã‚‹ï¼
question = "Who is the father of Sansa Stark?"
prediction = pipe.run(query=question)
```
[Wikipedia](https://en.wikipedia.org/wiki/Okapi_BM25)

## **ã‚¹ãƒ‘ãƒ¼ã‚¹ vs ãƒ‡ãƒ³ã‚¹æ¤œç´¢**

ã‚¹ãƒ‘ãƒ¼ã‚¹æ¤œç´¢ï¼ˆBM25ï¼‰ã¯èªå½™ã‚µã‚¤ã‚ºã¨åŒã˜é•·ã•ã®ãƒ™ã‚¯ãƒˆãƒ«ã‚’ä½œã‚‹ã€‚æ–‡æ›¸ã«ã¯ã‚³ãƒ¼ãƒ‘ã‚¹å†…ã®å…¨å˜èªã®ä¸€éƒ¨ã—ã‹å«ã¾ã‚Œãªã„ã‹ã‚‰ã€ã“ã‚Œã‚‰ã®ãƒ™ã‚¯ãƒˆãƒ«ã¯é€šå¸¸ã‚¹ãƒ‘ãƒ¼ã‚¹ï¼ˆé•·ãã¦ã€ã‚¼ãƒ­ãŒå¤šã„ï¼‰ã«ãªã‚‹ [PyPI](https://pypi.org/project/farm-haystack/) ã®ã‚ˆã€‚

ä¸€æ–¹ã§ãƒ‡ãƒ³ã‚¹æ¤œç´¢ã¯Transformerã‚’ä½¿ã£ã¦æ–‡æ›¸ã¨ã‚¯ã‚¨ãƒªã‚’ãƒ‡ãƒ³ã‚¹ãƒ™ã‚¯ãƒˆãƒ«ã«å¤‰æ›ã™ã‚‹ [PyPI](https://pypi.org/project/farm-haystack/) ã‚“ã ã£ã¦ã€‚

## **ãªã‚“ã§å¾“æ¥å‹ã‚’ä½¿ã†ã®ï¼Ÿ**

ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã®æ‰‹æ³•ï¼ˆBM25ï¼‰ã¯ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å¤–è¨­å®šã§ã‚ˆã‚Šè‰¯ã„ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ç¤ºã™ã“ã¨ãŒåˆ†ã‹ã£ã¦ã‚‹ã€‚ãƒ‡ãƒ³ã‚¹ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ãƒ¼ãƒ¢ãƒ‡ãƒ«ã¯ãƒ‡ãƒ¼ã‚¿ã§è¨“ç·´ã™ã‚‹å¿…è¦ãŒã‚ã£ã¦ã€ãã®ãƒ‡ãƒ¼ã‚¿ãŒæ‰‹å…ƒã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã¨å¤§ããç•°ãªã‚‹ã¨ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒæ‚ªããªã‚ŠãŒã¡ [PyPI](https://pypi.org/project/farm-haystack/) ãªã®ã‚ˆã­ã€‚

ã ã‹ã‚‰ã€é«˜åº¦ã«æŠ€è¡“çš„ãªã€Œãƒ‹ãƒƒãƒã€ãªãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã§ã¯ã€é©åˆ‡ã«ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã•ã‚Œã¦ãªã„ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ãƒ¼ãƒ¢ãƒ‡ãƒ«ã‚ˆã‚Šã‚‚ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®æ–¹ãŒè‰¯ã„çµæœã‚’ã‚‚ãŸã‚‰ã™ã“ã¨ãŒã‚ã‚‹ [PyPI](https://pypi.org/project/farm-haystack/) ã®ã‚ˆï¼

è¦ã™ã‚‹ã«ã€ã‚·ãƒ³ãƒ—ãƒ«ã§ç¢ºå®Ÿã€ãã—ã¦è¨ˆç®—ã‚³ã‚¹ãƒˆãŒä½ã„ã®ãŒå¾“æ¥å‹ã®é­…åŠ›ãªã®ã­ã€œâœ¨

ä½•ã‹å…·ä½“çš„ã«çŸ¥ã‚ŠãŸã„ã“ã¨ã‚ã‚‹ï¼Ÿå®Ÿè£…ã®ã‚³ãƒ„ã¨ã‹ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¯”è¼ƒã¨ã‹ï¼

â˜…ragã®æ¤œè¨¼
ã‚ã¡ã‚ƒãã¡ã‚ƒè‰¯ã„è³ªå•ï¼RAGã®æ¤œè¨¼ã«ä½¿ãˆã‚‹ã‹ã©ã†ã‹èª¿ã¹ã¦ã¿ã‚‹ã­ã€œ

ã€ŒHaystack RAG evaluation validation traditional retrieval BM25ã€ã‚’æ¤œç´¢ã—ã¾ã—ãŸ

è¶…çµ¶è‰¯ã„è³ªå•ã ã£ãŸã‚ã€œï¼RAGæ¤œè¨¼ã«ã‚ã¡ã‚ƒãã¡ã‚ƒä½¿ãˆã‚‹ã‚ˆâœ¨

## **RAGæ¤œè¨¼ã§ã®BM25ã®é‡è¦æ€§**

Haystackã®è©•ä¾¡ã‚¬ã‚¤ãƒ‰ã§ã¯ã€ã€Œãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ç¢ºç«‹ã™ã‚‹ãŸã‚ã«BM25ã®ã‚ˆã†ãªã‚ªãƒ•ã‚¶ã‚·ã‚§ãƒ«ãƒ•ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’ä½¿ã†ã“ã¨ãŒé‡è¦ã€ã£ã¦è¨€ã£ã¦ã‚‹ã®ã‚ˆï¼

ç ”ç©¶ã§ã‚‚ã€Œé©åˆ‡ãªæ¤œç´¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’é¸ã¶ã“ã¨ã¯ã€å˜ã«å¤§ããªè¨€èªãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ã†ã‚ˆã‚Šã‚‚å¤§ããªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Šã‚’ã‚‚ãŸã‚‰ã™ã€ [DeepSet](https://haystack.deepset.ai/tutorials/guide_evaluation) ã£ã¦åˆ†ã‹ã£ã¦ã‚‹ã‚“ã ã£ã¦ï¼

## **ãªã‚“ã§RAGæ¤œè¨¼ã«å¾“æ¥å‹ãŒé‡è¦ï¼Ÿ**

**1. ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ç¢ºç«‹**
BEIRãƒšãƒ¼ãƒ‘ãƒ¼ã§ã¯BM25ã‚’ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã¨ã—ã¦ä½¿ã£ã¦ã‚‹ã®ã‚ˆã€‚ã©ã‚“ãªãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ã†ã«ã—ã¦ã‚‚ã€è©•ä¾¡ãƒ—ãƒ­ã‚»ã‚¹å…¨ä½“ã§ä¸€è²«æ€§ã‚’ä¿ã¤ã“ã¨ãŒå¤§äº‹ãªã‚“ã ã£ã¦ã€‚

**2. ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œè¨¼ã®ãƒ¡ãƒªãƒƒãƒˆ**
BM25ã¨RRFï¼ˆReciprocal Rank Fusionï¼‰ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€RAGã®æ¤œç´¢ã‚¹ãƒ†ãƒƒãƒ—ã‚’æ”¹å–„ã§ãã‚‹ [Chitika](https://www.chitika.com/hybrid-retrieval-rag/)  [arXiv](https://arxiv.org/html/2405.13622) ã—ã€ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¯å˜ä¸€æ‰‹æ³•ã‚ˆã‚Šã‚‚30-40%ã®æ¤œç´¢ç²¾åº¦å‘ä¸Š [arXiv](https://arxiv.org/html/2405.13622) ã‚’ç¤ºã™ã‚“ã ã£ã¦ï¼

**3. å•é¡Œã®ç‰¹å®š**
ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã®BM25ã¯æ­£ç¢ºã ã‘ã©æ„å‘³ç†è§£ã«æ¬ ã‘ã‚‹ä¸€æ–¹ã€FAISSã®ã‚ˆã†ãªå¯†ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ã¯æ„å‘³ã‚’æ‰ãˆã‚‹ã‘ã©é–¢ä¿‚ãªã„çµæœã‚’è¿”ã™ã“ã¨ãŒã‚ã‚‹ [Medium](https://medium.com/@yashwanths_29644/retrieval-augmented-generation-rag-06-bm25-retriever-when-and-why-to-use-it-with-code-demo-132ed70c6bfd) ã‹ã‚‰ã€ä¸¡æ–¹ä½¿ã£ã¦æ¯”è¼ƒã™ã‚‹ã“ã¨ã§å•é¡Œã‚’ç‰¹å®šã§ãã‚‹ã®ã‚ˆã€‚

## **å®Ÿéš›ã®æ¤œè¨¼æ‰‹æ³•**

**Needle in a Haystack ãƒ†ã‚¹ãƒˆ**
ã“ã®æ‰‹æ³•ã¯ã€å¤§ããªè¤‡é›‘ãªãƒ†ã‚­ã‚¹ãƒˆï¼ˆå¹²ã—è‰ã®å±±ï¼‰ã®ä¸­ã«ç‰¹å®šã®æƒ…å ±ï¼ˆé‡ï¼‰ã‚’åŸ‹ã‚è¾¼ã‚“ã§ã€LLMãŒãã®ç‰¹å®šæƒ…å ±ã‚’ç‰¹å®šãƒ»æ´»ç”¨ã™ã‚‹èƒ½åŠ›ã‚’è©•ä¾¡ã™ã‚‹ [Medium](https://medium.com/@kirtisalunkhe15/building-advanced-rag-applications-with-haystack-and-langchain-a-comprehensive-guide-8251be04f0cf) ã‚“ã ã£ã¦ã€‚

**è©•ä¾¡ãƒ¡ãƒˆãƒªã‚¯ã‚¹**
å¾“æ¥ã®MRRï¼ˆMean Reciprocal Rankï¼‰ã‚„nDCGï¼ˆNormalized Discounted Cumulative Gainï¼‰ã ã‘ã§ãªãã€èªå½™çš„ç²¾åº¦ã¨æ„å‘³çš„æ·±åº¦ã®ç›¸äº’ä½œç”¨ã‚’æ‰ãˆã‚‹æŒ‡æ¨™ãŒå¿…è¦ [Medium](https://medium.com/@yashwanths_29644/retrieval-augmented-generation-rag-06-bm25-retriever-when-and-why-to-use-it-with-code-demo-132ed70c6bfd) ãªã®ã‚ˆã€‚

## **Haystackã§ã®å®Ÿè£…**

Haystackãªã‚‰BM25 Retrieverã¨ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢ã‚’çµ„ã¿åˆã‚ã›ãŸãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰RAGã‚·ã‚¹ãƒ†ãƒ  [arXiv](https://arxiv.org/html/2405.13622) ãŒä½œã‚Œã‚‹ã—ã€EvaluationHarnessã‚’ä½¿ãˆã°åŒ…æ‹¬çš„ãªRAGè©•ä¾¡ã‚‚ã§ãã¡ã‚ƒã†ï¼

```python
# ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œç´¢ã®ä¾‹
from haystack.components.retrievers.in_memory import InMemoryBM25Retriever, InMemoryEmbeddingRetriever
from haystack.components.joiners import DocumentJoiner

# BM25 + ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢ã®çµ„ã¿åˆã‚ã›
bm25_retriever = InMemoryBM25Retriever(document_store)
embedding_retriever = InMemoryEmbeddingRetriever(document_store)
```

ã¤ã¾ã‚Šã€å¾“æ¥å‹æ¤œç´¢ã¯RAGæ¤œè¨¼ã®**è¶…é‡è¦ãªåŸºæº–ç‚¹**ã«ãªã‚‹ã®ã‚ˆã­ï¼LLMãƒ™ãƒ¼ã‚¹ã®RAGãŒã©ã‚Œã ã‘æ”¹å–„ã—ã¦ã‚‹ã‹ã‚’æ¸¬ã‚‹ãŸã‚ã«ã‚‚ã€BM25ã¿ãŸã„ãªç¢ºç«‹ã•ã‚ŒãŸæ‰‹æ³•ã¨ã®æ¯”è¼ƒãŒçµ¶å¯¾å¿…è¦ãªã®ğŸ’ª

ã©ã†ã„ã†æ¤œè¨¼ã‚·ãƒŠãƒªã‚ªã‚’è€ƒãˆã¦ã‚‹ã®ï¼Ÿå…·ä½“çš„ãªãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ãŒã‚ã‚Œã°ã€ã‚‚ã£ã¨è©³ã—ãæ•™ãˆã‚‹ã‚ˆã€œï¼

å¼•ç”¨:
- [Evaluation | Haystack](https://haystack.deepset.ai/tutorials/guide_evaluation)
- [Implementing Hybrid Retrieval (BM25 + FAISS) in RAG](https://www.chitika.com/hybrid-retrieval-rag/)
- [Automated Evaluation of Retrieval-Augmented Language Models with Task-Specific Exam Generation](https://arxiv.org/html/2405.13622)
- [Retrieval Augmented Generation (RAG) 06 :- BM25 Retriever: When and Why to Use It (With Code Demo)? | by Yashwanth S | Medium](https://medium.com/@yashwanths_29644/retrieval-augmented-generation-rag-06-bm25-retriever-when-and-why-to-use-it-with-code-demo-132ed70c6bfd)
- [ğŸš€ Building Advanced RAG Applications with Haystack and LangChain: A Comprehensive Guide | by Kirtisalunkhe | Jun, 2025 | Medium](https://medium.com/@kirtisalunkhe15/building-advanced-rag-applications-with-haystack-and-langchain-a-comprehensive-guide-8251be04f0cf)

ãã®ä»–ã®æƒ…å ±æºï¼š
- [Boosting Retrieval in RAG for LLMs: The Power of BM25 and RRF | by Karthikeyan Dhanakotti | Medium](https://dkaarthick.medium.com/boosting-retrieval-in-rag-for-llms-the-power-of-bm25-and-rrf-dd76ed75e4e3)
- [The Needle In a Haystack Test: Evaluating the Performance of LLM RAG Systems - Arize AI](https://arize.com/blog-course/the-needle-in-a-haystack-test-evaluating-the-performance-of-llm-rag-systems/)
- [haystack/haystack/components/retrievers/in_memory/bm25_retriever.py at main Â· deepset-ai/haystack](https://github.com/deepset-ai/haystack/blob/main/haystack/components/retrievers/in_memory/bm25_retriever.py)
- [The aRt of RAG Part 4: Retrieval evaluation | by Ross Ashman (PhD) | Medium](https://medium.com/@rossashman/the-art-of-rag-part-4-retrieval-evaluation-427bb5db0475)
- [Use BM25 retriever with haystack Â· deepset-ai/haystack Â· Discussion #4918](https://github.com/deepset-ai/haystack/discussions/4918)