// ========================================
// 1. User Control ã‚¯ãƒ©ã‚¹ (PersonInfoControl.cs)
// ========================================
using System;
using System.Windows.Forms;

public partial class PersonInfoControl : UserControl
{
    // ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ãƒ‡ãƒ¼ã‚¿ã®ã‚„ã‚Šå–ã‚Šã‚’ã™ã‚‹
    public string PersonName
    {
        get { return txtName.Text; }
        set { txtName.Text = value; }
    }

    public int PersonAge
    {
        get 
        { 
            int age;
            return int.TryParse(txtAge.Text, out age) ? age : 0;
        }
        set { txtAge.Text = value.ToString(); }
    }

    // ã‚«ã‚¹ã‚¿ãƒ ã‚¤ãƒ™ãƒ³ãƒˆã‚’å®šç¾©
    public event EventHandler PersonUpdated;
    public event EventHandler BackRequested;  // æˆ»ã‚‹ãƒœã‚¿ãƒ³ç”¨

    public PersonInfoControl()
    {
        InitializeComponent();
        
        // ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¨­å®š
        btnUpdate.Click += BtnUpdate_Click;
        btnBack.Click += BtnBack_Click;
        
        // åˆæœŸå€¤è¨­å®š
        PersonName = "";
        PersonAge = 0;
    }

    private void BtnUpdate_Click(object sender, EventArgs e)
    {
        // å…¥åŠ›ãƒã‚§ãƒƒã‚¯
        if (string.IsNullOrWhiteSpace(PersonName))
        {
            MessageBox.Show("åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼", "ã‚¨ãƒ©ãƒ¼", 
                          MessageBoxButtons.OK, MessageBoxIcon.Warning);
            return;
        }

        if (PersonAge < 0 || PersonAge > 150)
        {
            MessageBox.Show("æ­£ã—ã„å¹´é½¢ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆ0-150ï¼‰", "ã‚¨ãƒ©ãƒ¼", 
                          MessageBoxButtons.OK, MessageBoxIcon.Warning);
            return;
        }

        // ãƒ©ãƒ™ãƒ«ã‚’æ›´æ–°
        lblInfo.Text = $"æ›´æ–°æ¸ˆã¿: {PersonName} ({PersonAge}æ­³)";
        
        // ã‚«ã‚¹ã‚¿ãƒ ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºç«
        PersonUpdated?.Invoke(this, EventArgs.Empty);
    }

    private void BtnBack_Click(object sender, EventArgs e)
    {
        // ãƒ¡ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ ã«æˆ»ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºç«
        BackRequested?.Invoke(this, EventArgs.Empty);
    }

    // ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒ¡ã‚½ãƒƒãƒ‰ã§å¤–éƒ¨ã‹ã‚‰ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«å¯èƒ½
    public void ClearInfo()
    {
        PersonName = "";
        PersonAge = 0;
        lblInfo.Text = "æœªè¨­å®š";
    }

    public bool IsValidInfo()
    {
        return !string.IsNullOrWhiteSpace(PersonName) && PersonAge > 0 && PersonAge <= 150;
    }
}

// ========================================
// 2. User Control ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼éƒ¨åˆ† (PersonInfoControl.Designer.cs)
// ========================================
partial class PersonInfoControl
{
    private System.ComponentModel.IContainer components = null;
    private Label lblTitle;
    private Label lblName;
    private Label lblAge;
    private TextBox txtName;
    private TextBox txtAge;
    private Button btnUpdate;
    private Button btnBack;
    private Label lblInfo;
    private Panel panelMain;

    protected override void Dispose(bool disposing)
    {
        if (disposing && (components != null))
        {
            components.Dispose();
        }
        base.Dispose(disposing);
    }

    private void InitializeComponent()
    {
        this.lblTitle = new Label();
        this.lblName = new Label();
        this.lblAge = new Label();
        this.txtName = new TextBox();
        this.txtAge = new TextBox();
        this.btnUpdate = new Button();
        this.btnBack = new Button();
        this.lblInfo = new Label();
        this.panelMain = new Panel();
        this.panelMain.SuspendLayout();
        this.SuspendLayout();
        
        // panelMain
        this.panelMain.BackColor = System.Drawing.Color.LightBlue;
        this.panelMain.BorderStyle = BorderStyle.FixedSingle;
        this.panelMain.Controls.Add(this.lblTitle);
        this.panelMain.Controls.Add(this.lblName);
        this.panelMain.Controls.Add(this.txtName);
        this.panelMain.Controls.Add(this.lblAge);
        this.panelMain.Controls.Add(this.txtAge);
        this.panelMain.Controls.Add(this.btnUpdate);
        this.panelMain.Controls.Add(this.lblInfo);
        this.panelMain.Controls.Add(this.btnBack);
        this.panelMain.Location = new System.Drawing.Point(20, 20);
        this.panelMain.Name = "panelMain";
        this.panelMain.Size = new System.Drawing.Size(350, 250);
        this.panelMain.TabIndex = 0;
        
        // lblTitle
        this.lblTitle.Font = new System.Drawing.Font("MS UI Gothic", 12F, System.Drawing.FontStyle.Bold);
        this.lblTitle.ForeColor = System.Drawing.Color.DarkBlue;
        this.lblTitle.Location = new System.Drawing.Point(10, 10);
        this.lblTitle.Name = "lblTitle";
        this.lblTitle.Size = new System.Drawing.Size(330, 23);
        this.lblTitle.TabIndex = 0;
        this.lblTitle.Text = "ğŸ“ å€‹äººæƒ…å ±å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ";
        this.lblTitle.TextAlign = System.Drawing.ContentAlignment.MiddleCenter;
        
        // lblName
        this.lblName.AutoSize = true;
        this.lblName.Font = new System.Drawing.Font("MS UI Gothic", 9F);
        this.lblName.Location = new System.Drawing.Point(20, 50);
        this.lblName.Name = "lblName";
        this.lblName.Size = new System.Drawing.Size(41, 12);
        this.lblName.TabIndex = 1;
        this.lblName.Text = "ãŠåå‰:";
        
        // txtName
        this.txtName.Font = new System.Drawing.Font("MS UI Gothic", 10F);
        this.txtName.Location = new System.Drawing.Point(80, 47);
        this.txtName.Name = "txtName";
        this.txtName.Size = new System.Drawing.Size(200, 21);
        this.txtName.TabIndex = 2;
        
        // lblAge
        this.lblAge.AutoSize = true;
        this.lblAge.Font = new System.Drawing.Font("MS UI Gothic", 9F);
        this.lblAge.Location = new System.Drawing.Point(20, 85);
        this.lblAge.Name = "lblAge";
        this.lblAge.Size = new System.Drawing.Size(29, 12);
        this.lblAge.TabIndex = 3;
        this.lblAge.Text = "å¹´é½¢:";
        
        // txtAge
        this.txtAge.Font = new System.Drawing.Font("MS UI Gothic", 10F);
        this.txtAge.Location = new System.Drawing.Point(80, 82);
        this.txtAge.Name = "txtAge";
        this.txtAge.Size = new System.Drawing.Size(80, 21);
        this.txtAge.TabIndex = 4;
        
        // btnUpdate
        this.btnUpdate.BackColor = System.Drawing.Color.LightGreen;
        this.btnUpdate.Font = new System.Drawing.Font("MS UI Gothic", 9F, System.Drawing.FontStyle.Bold);
        this.btnUpdate.Location = new System.Drawing.Point(200, 80);
        this.btnUpdate.Name = "btnUpdate";
        this.btnUpdate.Size = new System.Drawing.Size(80, 25);
        this.btnUpdate.TabIndex = 5;
        this.btnUpdate.Text = "âœ… æ›´æ–°";
        this.btnUpdate.UseVisualStyleBackColor = false;
        
        // lblInfo
        this.lblInfo.BackColor = System.Drawing.Color.White;
        this.lblInfo.BorderStyle = BorderStyle.FixedSingle;
        this.lblInfo.Font = new System.Drawing.Font("MS UI Gothic", 9F);
        this.lblInfo.ForeColor = System.Drawing.Color.DarkGreen;
        this.lblInfo.Location = new System.Drawing.Point(20, 125);
        this.lblInfo.Name = "lblInfo";
        this.lblInfo.Size = new System.Drawing.Size(260, 50);
        this.lblInfo.TabIndex = 6;
        this.lblInfo.Text = "æœªè¨­å®š";
        this.lblInfo.TextAlign = System.Drawing.ContentAlignment.MiddleCenter;
        
        // btnBack
        this.btnBack.BackColor = System.Drawing.Color.LightCoral;
        this.btnBack.Font = new System.Drawing.Font("MS UI Gothic", 9F, System.Drawing.FontStyle.Bold);
        this.btnBack.Location = new System.Drawing.Point(20, 200);
        this.btnBack.Name = "btnBack";
        this.btnBack.Size = new System.Drawing.Size(100, 30);
        this.btnBack.TabIndex = 7;
        this.btnBack.Text = "ğŸ”™ æˆ»ã‚‹";
        this.btnBack.UseVisualStyleBackColor = false;
        
        // PersonInfoControl
        this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 12F);
        this.AutoScaleMode = AutoScaleMode.Font;
        this.BackColor = System.Drawing.SystemColors.Control;
        this.Controls.Add(this.panelMain);
        this.Name = "PersonInfoControl";
        this.Size = new System.Drawing.Size(400, 300);
        this.panelMain.ResumeLayout(false);
        this.panelMain.PerformLayout();
        this.ResumeLayout(false);
    }
}

// ========================================
// 3. ãƒ¡ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ  (MainForm.cs)
// ========================================
using System;
using System.Drawing;
using System.Windows.Forms;

public partial class MainForm : Form
{
    private PersonInfoControl personInfoControl;
    private Panel panelMenu;
    private Label lblWelcome;
    private Button btnShowPersonForm;
    private Button btnShowAbout;
    private Button btnExit;
    private Label lblStatus;

    public MainForm()
    {
        InitializeComponent();
        
        // åˆæœŸçŠ¶æ…‹ã¯ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¡¨ç¤º
        ShowMenuPanel();
        
        // ã‚¤ãƒ™ãƒ³ãƒˆè¨­å®š
        btnShowPersonForm.Click += BtnShowPersonForm_Click;
        btnShowAbout.Click += BtnShowAbout_Click;
        btnExit.Click += BtnExit_Click;
    }

    private void ShowMenuPanel()
    {
        // User Controlã‚’éš ã—ã¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¡¨ç¤º
        if (personInfoControl != null)
        {
            personInfoControl.Visible = false;
        }
        panelMenu.Visible = true;
        lblStatus.Text = "ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”»é¢";
    }

    private void ShowPersonInfoControl()
    {
        // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’éš ã—ã¦User Controlã‚’è¡¨ç¤º
        panelMenu.Visible = false;
        
        if (personInfoControl == null)
        {
            personInfoControl = new PersonInfoControl();
            personInfoControl.Location = new Point(50, 50);
            personInfoControl.PersonUpdated += PersonControl_Updated;
            personInfoControl.BackRequested += PersonControl_BackRequested;
            this.Controls.Add(personInfoControl);
        }
        
        personInfoControl.Visible = true;
        lblStatus.Text = "å€‹äººæƒ…å ±å…¥åŠ›ç”»é¢";
    }

    private void BtnShowPersonForm_Click(object sender, EventArgs e)
    {
        ShowPersonInfoControl();
    }

    private void BtnShowAbout_Click(object sender, EventArgs e)
    {
        MessageBox.Show("User Control ã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³\n\n" +
                       "ã“ã®ã‚¢ãƒ—ãƒªã¯ç”»é¢åˆ‡ã‚Šæ›¿ãˆã®ãƒ‡ãƒ¢ã§ã™â™ª\n" +
                       "ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨User ControlãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã€œ",
                       "ã‚¢ãƒ—ãƒªã«ã¤ã„ã¦",
                       MessageBoxButtons.OK,
                       MessageBoxIcon.Information);
    }

    private void BtnExit_Click(object sender, EventArgs e)
    {
        if (MessageBox.Show("ã‚¢ãƒ—ãƒªã‚’çµ‚äº†ã—ã¾ã™ã‹ï¼Ÿ", "ç¢ºèª", 
                           MessageBoxButtons.YesNo, 
                           MessageBoxIcon.Question) == DialogResult.Yes)
        {
            this.Close();
        }
    }

    private void PersonControl_Updated(object sender, EventArgs e)
    {
        PersonInfoControl control = sender as PersonInfoControl;
        if (control != null && control.IsValidInfo())
        {
            lblStatus.Text = $"æ›´æ–°å®Œäº†: {control.PersonName}ã•ã‚“ ({control.PersonAge}æ­³)";
        }
    }

    private void PersonControl_BackRequested(object sender, EventArgs e)
    {
        ShowMenuPanel();
    }

    private void InitializeComponent()
    {
        this.panelMenu = new Panel();
        this.lblWelcome = new Label();
        this.btnShowPersonForm = new Button();
        this.btnShowAbout = new Button();
        this.btnExit = new Button();
        this.lblStatus = new Label();
        this.panelMenu.SuspendLayout();
        this.SuspendLayout();
        
        // panelMenu
        this.panelMenu.BackColor = System.Drawing.Color.LightYellow;
        this.panelMenu.BorderStyle = BorderStyle.FixedSingle;
        this.panelMenu.Controls.Add(this.lblWelcome);
        this.panelMenu.Controls.Add(this.btnShowPersonForm);
        this.panelMenu.Controls.Add(this.btnShowAbout);
        this.panelMenu.Controls.Add(this.btnExit);
        this.panelMenu.Location = new System.Drawing.Point(50, 50);
        this.panelMenu.Name = "panelMenu";
        this.panelMenu.Size = new System.Drawing.Size(350, 300);
        this.panelMenu.TabIndex = 0;
        
        // lblWelcome
        this.lblWelcome.Font = new System.Drawing.Font("MS UI Gothic", 14F, System.Drawing.FontStyle.Bold);
        this.lblWelcome.ForeColor = System.Drawing.Color.DarkBlue;
        this.lblWelcome.Location = new System.Drawing.Point(20, 30);
        this.lblWelcome.Name = "lblWelcome";
        this.lblWelcome.Size = new System.Drawing.Size(310, 50);
        this.lblWelcome.TabIndex = 0;
        this.lblWelcome.Text = "ğŸ‰ User Control ãƒ‡ãƒ¢\nãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¸ã‚ˆã†ã“ãï¼";
        this.lblWelcome.TextAlign = System.Drawing.ContentAlignment.MiddleCenter;
        
        // btnShowPersonForm
        this.btnShowPersonForm.BackColor = System.Drawing.Color.LightBlue;
        this.btnShowPersonForm.Font = new System.Drawing.Font("MS UI Gothic", 10F, System.Drawing.FontStyle.Bold);
        this.btnShowPersonForm.Location = new System.Drawing.Point(75, 110);
        this.btnShowPersonForm.Name = "btnShowPersonForm";
        this.btnShowPersonForm.Size = new System.Drawing.Size(200, 40);
        this.btnShowPersonForm.TabIndex = 1;
        this.btnShowPersonForm.Text = "ğŸ“ å€‹äººæƒ…å ±å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ";
        this.btnShowPersonForm.UseVisualStyleBackColor = false;
        
        // btnShowAbout
        this.btnShowAbout.BackColor = System.Drawing.Color.LightGreen;
        this.btnShowAbout.Font = new System.Drawing.Font("MS UI Gothic", 10F, System.Drawing.FontStyle.Bold);
        this.btnShowAbout.Location = new System.Drawing.Point(75, 170);
        this.btnShowAbout.Name = "btnShowAbout";
        this.btnShowAbout.Size = new System.Drawing.Size(200, 40);
        this.btnShowAbout.TabIndex = 2;
        this.btnShowAbout.Text = "â„¹ï¸ ã‚¢ãƒ—ãƒªã«ã¤ã„ã¦";
        this.btnShowAbout.UseVisualStyleBackColor = false;
        
        // btnExit
        this.btnExit.BackColor = System.Drawing.Color.LightCoral;
        this.btnExit.Font = new System.Drawing.Font("MS UI Gothic", 10F, System.Drawing.FontStyle.Bold);
        this.btnExit.Location = new System.Drawing.Point(75, 230);
        this.btnExit.Name = "btnExit";
        this.btnExit.Size = new System.Drawing.Size(200, 40);
        this.btnExit.TabIndex = 3;
        this.btnExit.Text = "âŒ çµ‚äº†";
        this.btnExit.UseVisualStyleBackColor = false;
        
        // lblStatus
        this.lblStatus.BackColor = System.Drawing.Color.White;
        this.lblStatus.BorderStyle = BorderStyle.FixedSingle;
        this.lblStatus.Font = new System.Drawing.Font("MS UI Gothic", 9F);
        this.lblStatus.Location = new System.Drawing.Point(12, 400);
        this.lblStatus.Name = "lblStatus";
        this.lblStatus.Size = new System.Drawing.Size(460, 23);
        this.lblStatus.TabIndex = 1;
        this.lblStatus.Text = "ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”»é¢";
        this.lblStatus.TextAlign = System.Drawing.ContentAlignment.MiddleLeft;
        
        // MainForm
        this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 12F);
        this.AutoScaleMode = AutoScaleMode.Font;
        this.BackColor = System.Drawing.SystemColors.Control;
        this.ClientSize = new System.Drawing.Size(484, 435);
        this.Controls.Add(this.lblStatus);
        this.Controls.Add(this.panelMenu);
        this.FormBorderStyle = FormBorderStyle.FixedSingle;
        this.MaximizeBox = false;
        this.Name = "MainForm";
        this.StartPosition = FormStartPosition.CenterScreen;
        this.Text = "User Control ç”»é¢åˆ‡ã‚Šæ›¿ãˆã‚µãƒ³ãƒ—ãƒ«";
        this.panelMenu.ResumeLayout(false);
        this.ResumeLayout(false);
    }
}

// ========================================
// 4. Program.cs (ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ)
// ========================================
using System;
using System.Windows.Forms;

static class Program
{
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new MainForm());
    }
}